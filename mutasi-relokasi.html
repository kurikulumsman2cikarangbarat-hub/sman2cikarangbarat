function doPost(e) {
  var lock = LockService.getScriptLock();
  lock.tryLock(10000); // Menghindari bentrokan data masuk bersamaan

  try {
    // Pastikan nama sheet sesuai: "Sheet1"
    var doc = SpreadsheetApp.getActiveSpreadsheet();
    var sheet = doc.getSheetByName("Sheet1") || doc.getSheets()[0];
    
    var jsonData = JSON.parse(e.postData.contents);
    
    // Menyusun baris sesuai urutan kolom
    sheet.appendRow([
      jsonData.nama,
      "'" + jsonData.nip,
      jsonData.mapel,
      jsonData.sertifikat,
      "'" + jsonData.wa // Kolom 5: Nomor WA
    ]);

    return ContentService
          .createTextOutput(JSON.stringify({ "result": "success" }))
          .setMimeType(ContentService.MimeType.JSON);
  } catch (f) {
    return ContentService
          .createTextOutput(JSON.stringify({ "result": "error", "error": f }))
          .setMimeType(ContentService.MimeType.JSON);
  } finally {
    lock.releaseLock();
  }
}

// Tetap sertakan doGet agar URL bisa diakses via browser jika perlu
function doGet(e) {
  return HtmlService.createHtmlOutput("Backend Berjalan. Silakan gunakan Form HTML.");
}
Penting: Setelah ganti kode, klik Deploy > New Deployment lagi agar perubahan tersimpan.

2. Kode Frontend (HTML)
Gunakan kode ini. Saya telah menambahkan input Nomor WA dan logika untuk otomatis membuka WhatsApp setelah data tersimpan di Google Sheets.

HTML
<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Pengajuan Mutasi Guru</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background-color: #eef2f7; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; max-width: 450px; }
        h2 { text-align: center; color: #2c3e50; margin-bottom: 20px; }
        .form-group { margin-bottom: 15px; }
        label { display: block; margin-bottom: 5px; font-weight: bold; color: #34495e; }
        input, select { width: 100%; padding: 10px; border: 1px solid #ced4da; border-radius: 6px; box-sizing: border-box; }
        button { width: 100%; padding: 12px; background-color: #007bff; color: white; border: none; border-radius: 6px; font-size: 16px; cursor: pointer; font-weight: bold; }
        button:hover { background-color: #0056b3; }
        #status { text-align: center; margin-top: 15px; font-weight: bold; }
    </style>
</head>
<body>

<div class="container">
    <h2>Form Pendataan Guru</h2>
    <form id="mutasiForm">
        <div class="form-group">
            <label>Nama Lengkap</label>
            <input type="text" name="nama" placeholder="Nama Lengkap & Gelar" required>
        </div>
        <div class="form-group">
            <label>NIP</label>
            <input type="number" name="nip" placeholder="18 digit NIP" required>
        </div>
        <div class="form-group">
            <label>Mata Pelajaran</label>
            <select name="mapel" required>
                <option value="">-- Pilih --</option>
                <option value="Sejarah">Sejarah</option>
                <option value="Matematika">Matematika</option>
                <option value="Bahasa Sunda">Bahasa Sunda</option>
                <option value="PJOK">PJOK</option>
            </select>
        </div>
        <div class="form-group">
            <label>Sertifikat Guru Profesional?</label>
            <select name="sertifikat" required>
                <option value="">-- Pilih --</option>
                <option value="Sudah">Sudah</option>
                <option value="Belum">Belum</option>
            </select>
        </div>
        <div class="form-group">
            <label>Nomor WA Anda</label>
            <input type="tel" name="wa" placeholder="08xxxxxxx" required>
        </div>

        <button type="submit" id="btnSubmit">Simpan & Kirim Pesan</button>
    </form>
    <div id="status"></div>
</div>
    <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbzthUfoVELG3z_VTY1ClyxKnSV76BN9FtGha6sSyMOnKHQ93qPV0gFMhQ3Qtz_G0U2u/exec';
    const form = document.getElementById('mutasiForm');

    form.addEventListener('submit', e => {
        e.preventDefault();
        const btn = document.getElementById('btnSubmit');
        const status = document.getElementById('status');
        
        btn.disabled = true;
        btn.innerText = 'Sedang Mengirim...';

        // Ambil data
        const formData = new FormData(form);
        const dataObject = Object.fromEntries(formData.entries());

        // Gunakan Fetch dengan format JSON (Lebih stabil di Mobile modern)
        fetch(scriptURL, {
            method: 'POST',
            mode: 'no-cors', // Tetap gunakan no-cors untuk menghindari preflight error
            body: JSON.stringify(dataObject),
            headers: {
                'Content-Type': 'text/plain;charset=utf-8' // Trik agar tidak memicu CORS
            }
        })
        .then(() => {
            // Logika Pesan WhatsApp
            const noTujuan = "6285899888006";
            const teksSertifikat = dataObject.sertifikat.toLowerCase();
            const pesan = `Assalamu 'alaykum Warahmatullah, Perkenalkan Saya ${dataObject.nama} (${dataObject.nip}), guru mata pelajaran ${dataObject.mapel}, bermaksud mengajukan mutasi/relokasi ke SMAN 2 Cikarang Barat, saat ini Saya ${teksSertifikat} memiliki Sertifikat Guru Profesional.`;
            const waLink = `https://wa.me/${noTujuan}?text=${encodeURIComponent(pesan)}`;

            status.innerHTML = "✅ Data Berhasil Disimpan!";
            status.style.color = "green";

            // Redirect ke WA
            setTimeout(() => {
                window.location.href = waLink;
            }, 800);
        })
        .catch(error => {
            console.error('Error:', error);
            status.innerHTML = "❌ Gagal. Pastikan internet stabil.";
            status.style.color = "red";
            btn.disabled = false;
            btn.innerText = 'Kirim Ulang';
        });
    });
    </script>
</body>
</html>
